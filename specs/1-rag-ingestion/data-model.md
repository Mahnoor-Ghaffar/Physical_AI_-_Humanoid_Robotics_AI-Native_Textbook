# Data Model: RAG Content Ingestion Pipeline

**Feature**: RAG Content Ingestion Pipeline
**Date**: 2026-01-12

## Entities

### Document Chunk
**Description**: Represents a segment of text extracted from a web page with associated metadata
**Fields**:
- `id`: Unique identifier for the chunk (UUID/GUID)
- `content`: The actual text content of the chunk (string)
- `source_url`: URL of the original webpage where this chunk originated (string)
- `position`: Position of this chunk within the original document (integer)
- `length`: Character length of the content (integer)
- `created_at`: Timestamp when the chunk was created (datetime)
- `metadata`: Additional metadata such as headings, section titles, etc. (JSON/object)

### Embedding Vector
**Description**: Numerical representation of text content generated by Cohere models for semantic similarity calculations
**Fields**:
- `chunk_id`: Reference to the Document Chunk this embedding represents (foreign key)
- `vector`: Array of numerical values representing the embedding (float array, 1024 dimensions)
- `model_version`: Version of the embedding model used (string)
- `embedding_timestamp`: When the embedding was generated (datetime)

### Vector Index
**Description**: Collection of embedding vectors in Qdrant database with associated metadata for efficient similarity search
**Fields**:
- `collection_name`: Name of the Qdrant collection (string)
- `vector_size`: Dimensionality of vectors in this index (integer, 1024 for Cohere)
- `distance_metric`: Distance calculation method (string, e.g., "Cosine", "Euclidean")
- `total_vectors`: Count of vectors stored in the index (integer)
- `index_status`: Current status of the index (string, e.g., "ready", "updating", "error")

## Relationships

### Document Chunk → Embedding Vector
- One-to-One relationship
- Each document chunk corresponds to exactly one embedding vector
- Foreign key: Document Chunk.id → Embedding Vector.chunk_id

### Embedding Vector → Vector Index
- Many-to-One relationship
- Multiple embedding vectors belong to one vector index/collection
- Foreign key: Embedding Vector.collection_name → Vector Index.collection_name

## Validation Rules

### Document Chunk
- `content` must not be empty
- `source_url` must be a valid URL format
- `position` must be non-negative
- `length` must match actual content length

### Embedding Vector
- `vector` must have exactly 1024 dimensions
- `model_version` must match supported Cohere model versions
- `vector` values must be finite floats (not NaN or infinity)

### Vector Index
- `vector_size` must match the dimensionality of stored vectors (1024)
- `distance_metric` must be one of supported metrics (Cosine, Euclidean, Dot)
- `collection_name` must follow Qdrant naming conventions

## State Transitions

### Document Chunk
- `created` → `processed` → `embedded` → `indexed`
  - `created`: Chunk extracted from source
  - `processed`: Cleaned and validated
  - `embedded`: Embedding generated
  - `indexed`: Stored in vector database

## Indexing Strategy

### Primary Index
- Qdrant collection with HNSW index for fast approximate nearest neighbor search
- Enables efficient similarity search operations

### Metadata Filtering
- Support for filtering by source_url and other metadata fields
- Enables targeted searches within specific documents or sections